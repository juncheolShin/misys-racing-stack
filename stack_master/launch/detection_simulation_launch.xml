<!-- -*- mode: XML -*- -->
<launch>
  <arg name="racecar_version" default="NUC2" description="'SIM' / 'NUCx'" />
  <arg name="map_dir" description="Map dir in stack_master/maps" />
  <arg name="map_name" description="Map name in stack_master/maps" />
  <arg name="sim" default="False" description="True/False if you want to run simulation" />
  <arg name="loc_algorithm" default="slam" description="'slam' / 'synpf' to switch localisation algorithm" />


  <!-- <let name="map_path" value="$(find-pkg-share stack_master)/maps/$(var map_name)" /> -->
  <let name="maps_root" value="$(find-pkg-prefix stack_master)/../../stack_master/maps" />
  <let name="map_path" value="$(var maps_root)/$(var map_dir)" />

  <!-- launch global parameter node -->
  <node pkg="stack_master" name="global_parameters" exec="global_parameter_node">
    <param name="racecar_version" value="$(var racecar_version)" />
    <param name="sim" value="$(var sim)" />
    <param name="map_path" value="$(var map_path)" />
    <!-- Fails with l1 params for some reason
    <param from="$(find-pkg-share stack_master)/config/$(var racecar_version)/l1_params.yaml" /> -->
    <param name="use_sim_time" value="true" />
  </node>

  <!-- launch global trajectory republisher -->
  <node pkg="global_planner" name="global_republisher" exec="global_trajectory_publisher">
    <param name="map_path" value="$(var map_path)" />
  </node>


  <!-- launch sector tuner -->
  <node pkg="sector_tuner" name="sector_tuner" exec="sector_tuner">
    <param from="$(var map_path)/speed_scaling.yaml" />
  </node>

  <!-- launch ot sector tuner -->
  <node pkg="sector_tuner" name="ot_interpolator" exec="ot_interpolator">
    <param from="$(var map_path)/ot_sectors.yaml" />
  </node>

  <!-- launch lap analyser -->
  <!-- <node pkg="lap_analyser" name="lap_analyser" exec="lap_analyser" output="screen" /> -->

</launch>